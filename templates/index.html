<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Економетричний аналіз ВРП регіонів України</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f8f9fa;
        }
        .header {
            background-color: #3a4a58;
            color: white;
            padding: 20px 0;
            margin-bottom: 30px;
        }
        .card {
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            border-radius: 8px;
            border: none;
        }
        .card-header {
            background-color: #4e73df;
            color: white;
            border-radius: 8px 8px 0 0 !important;
            font-weight: bold;
        }
        .nav-tabs .nav-link.active {
            font-weight: bold;
            border-bottom: 3px solid #4e73df;
        }
        .prediction-result {
            font-size: 24px;
            font-weight: bold;
            color: #2c7be5;
        }
        #correlationHeatmap {
            height: 400px;
        }
        .coefficient-item {
            margin-bottom: 8px;
            padding: 8px;
            border-radius: 4px;
            background-color: #f1f5fb;
        }
        .r-squared {
            font-size: 18px;
            margin-top: 15px;
            padding: 10px;
            background-color: #e6f2ff;
            border-radius: 5px;
            font-weight: 500;
        }
        .equation-container {
            font-size: 18px;
            line-height: 1.5;
        }
        #regionsChart, #structureChart, #regressionChart {
            height: 400px;
        }
        #scatterChart {
            height: 300px;
        }
        #correlationHeatmap {
            height: 500px;
        }
        footer {
            margin-top: 50px;
        }
    </style>
</head>
<body>
    <div class="header text-center">
        <h1>Економетричний аналіз ВРП регіонів України</h1>
        <p class="lead">Інтерактивна система для аналізу та прогнозування валового регіонального продукту</p>
    </div>

    <div class="container">
        <ul class="nav nav-tabs" id="mainTab" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="dashboard-tab" data-bs-toggle="tab" data-bs-target="#dashboard" type="button" role="tab" aria-controls="dashboard" aria-selected="true">Інформаційна панель</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="prediction-tab" data-bs-toggle="tab" data-bs-target="#prediction" type="button" role="tab" aria-controls="prediction" aria-selected="false">Прогнозування ВРП</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="correlation-tab" data-bs-toggle="tab" data-bs-target="#correlation" type="button" role="tab" aria-controls="correlation" aria-selected="false">Кореляційна матриця</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="comparison-tab" data-bs-toggle="tab" data-bs-target="#comparison" type="button" role="tab" aria-controls="comparison" aria-selected="false">Порівняння регіонів</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="about-tab" data-bs-toggle="tab" data-bs-target="#about" type="button" role="tab" aria-controls="about" aria-selected="false">Про проект</button>
            </li>
        </ul>
        
        <div class="tab-content" id="mainTabContent">
            <!-- Інформаційна панель -->
            <div class="tab-pane fade show active" id="dashboard" role="tabpanel" aria-labelledby="dashboard-tab">
                <div class="card mt-4">
                    <div class="card-header">
                        Регресійна модель ВРП
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <h5>Рівняння регресії:</h5>
                                <div class="equation-container p-3 bg-light rounded mb-3" id="regressionEquation">
                                    <strong>ВРП = -874.54 + 0.155 × Основні засоби + 3.036 × Нові основні засоби + 0.070 × Роздрібний товарооборот</strong>
                                </div>
                                <div class="mt-3">
                                    <h6>Якість моделі:</h6>
                                    <ul>
                                        <li>Коефіцієнт детермінації (R²): <span id="modelRSquared">97.24%</span></li>
                                        <li>Стандартна помилка: <span id="modelStdError">856.32</span></li>
                                    </ul>
                                </div>
                                <div class="mt-3">
                                    <h6>Інтерпретація:</h6>
                                    <p>Рівняння показує вплив кожного фактора на ВРП. Значення коефіцієнтів вказують, наскільки змінюється ВРП при зміні відповідного фактора на одиницю.</p>
                                    <p>Наприклад, при збільшенні основних засобів на 1 млн грн, ВРП зростає в середньому на 0.155 млн грн, за умови незмінності інших факторів.</p>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <canvas id="regressionChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row mt-4">
                    <div class="col-lg-6">
                        <div class="card">
                            <div class="card-header">
                                Загальна статистика по ВРП регіонів
                            </div>
                            <div class="card-body">
                                <canvas id="regionsChart"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <div class="card">
                            <div class="card-header">
                                Взаємозалежність між показниками
                            </div>
                            <div class="card-body">
                                <canvas id="scatterChart"></canvas>
                                <div class="mt-3">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <label for="xVariable" class="form-label">Змінна X:</label>
                                            <select id="xVariable" class="form-select">
                                                <option value="assets">Основні засоби</option>
                                                <option value="investments">Інвестиції</option>
                                                <option value="employment">Зайнятість населення</option>
                                                <option value="enterprises">Кількість підприємств</option>
                                                <option value="income">Доходи населення</option>
                                                <option value="new_assets">Нові основні засоби</option>
                                                <option value="retail">Роздрібний товарооборот</option>
                                            </select>
                                        </div>
                                        <div class="col-md-6">
                                            <label for="yVariable" class="form-label">Змінна Y:</label>
                                            <select id="yVariable" class="form-select">
                                                <option value="grp">ВРП</option>
                                                <option value="assets">Основні засоби</option>
                                                <option value="investments">Інвестиції</option>
                                                <option value="employment">Зайнятість населення</option>
                                                <option value="enterprises">Кількість підприємств</option>
                                                <option value="income">Доходи населення</option>
                                                <option value="new_assets">Нові основні засоби</option>
                                                <option value="retail">Роздрібний товарооборот</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="row mt-4">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">
                                Структура економіки регіонів
                            </div>
                            <div class="card-body">
                                <canvas id="structureChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Прогнозування ВРП -->
            <div class="tab-pane fade" id="prediction" role="tabpanel" aria-labelledby="prediction-tab">
                <div class="row">
                    <div class="col-lg-8">
                        <div class="card mt-4">
                            <div class="card-header">
                                Налаштування моделі прогнозування
                            </div>
                            <div class="card-body">
                                <form id="predictionForm">
                                    <div class="mb-3">
                                        <label class="form-label">Виберіть змінні для моделі:</label>
                                        <div class="row">
                                            <div class="col-md-4 mb-2">
                                                <div class="form-check">
                                                    <input class="form-check-input variable-checkbox" type="checkbox" value="assets" id="var_assets" name="variables" checked>
                                                    <label class="form-check-label" for="var_assets">
                                                        Основні засоби
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="col-md-4 mb-2">
                                                <div class="form-check">
                                                    <input class="form-check-input variable-checkbox" type="checkbox" value="investments" id="var_investments" name="variables">
                                                    <label class="form-check-label" for="var_investments">
                                                        Інвестиції
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="col-md-4 mb-2">
                                                <div class="form-check">
                                                    <input class="form-check-input variable-checkbox" type="checkbox" value="employment" id="var_employment" name="variables">
                                                    <label class="form-check-label" for="var_employment">
                                                        Зайнятість населення
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="col-md-4 mb-2">
                                                <div class="form-check">
                                                    <input class="form-check-input variable-checkbox" type="checkbox" value="enterprises" id="var_enterprises" name="variables">
                                                    <label class="form-check-label" for="var_enterprises">
                                                        Кількість підприємств
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="col-md-4 mb-2">
                                                <div class="form-check">
                                                    <input class="form-check-input variable-checkbox" type="checkbox" value="income" id="var_income" name="variables">
                                                    <label class="form-check-label" for="var_income">
                                                        Доходи населення
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="col-md-4 mb-2">
                                                <div class="form-check">
                                                    <input class="form-check-input variable-checkbox" type="checkbox" value="new_assets" id="var_new_assets" name="variables" checked>
                                                    <label class="form-check-label" for="var_new_assets">
                                                        Нові основні засоби
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="col-md-4 mb-2">
                                                <div class="form-check">
                                                    <input class="form-check-input variable-checkbox" type="checkbox" value="retail" id="var_retail" name="variables" checked>
                                                    <label class="form-check-label" for="var_retail">
                                                        Роздрібний товарооборот
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label class="form-label">Введіть значення для прогнозу:</label>
                                        <div class="row values-inputs">
                                            <div class="col-md-6 mb-2 var-input-container" id="input_container_assets">
                                                <label for="value_assets" class="form-label">Основні засоби:</label>
                                                <input type="number" class="form-control" id="value_assets" name="values[assets]" value="43758" step="0.01">
                                            </div>
                                            <div class="col-md-6 mb-2 var-input-container" id="input_container_investments" style="display: none;">
                                                <label for="value_investments" class="form-label">Інвестиції:</label>
                                                <input type="number" class="form-control" id="value_investments" name="values[investments]" value="2740" step="0.01">
                                            </div>
                                            <div class="col-md-6 mb-2 var-input-container" id="input_container_employment" style="display: none;">
                                                <label for="value_employment" class="form-label">Зайнятість населення:</label>
                                                <input type="number" class="form-control" id="value_employment" name="values[employment]" value="899.7" step="0.01">
                                            </div>
                                            <div class="col-md-6 mb-2 var-input-container" id="input_container_enterprises" style="display: none;">
                                                <label for="value_enterprises" class="form-label">Кількість підприємств:</label>
                                                <input type="number" class="form-control" id="value_enterprises" name="values[enterprises]" value="43381" step="0.01">
                                            </div>
                                            <div class="col-md-6 mb-2 var-input-container" id="input_container_income" style="display: none;">
                                                <label for="value_income" class="form-label">Доходи населення:</label>
                                                <input type="number" class="form-control" id="value_income" name="values[income]" value="10022" step="0.01">
                                            </div>
                                            <div class="col-md-6 mb-2 var-input-container" id="input_container_new_assets">
                                                <label for="value_new_assets" class="form-label">Нові основні засоби:</label>
                                                <input type="number" class="form-control" id="value_new_assets" name="values[new_assets]" value="1804" step="0.01">
                                            </div>
                                            <div class="col-md-6 mb-2 var-input-container" id="input_container_retail">
                                                <label for="value_retail" class="form-label">Роздрібний товарооборот:</label>
                                                <input type="number" class="form-control" id="value_retail" name="values[retail]" value="2434.3" step="0.01">
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label class="form-label">Або виберіть регіон для заповнення значень:</label>
                                        <select class="form-select" id="regionSelect">
                                            <option value="">-- Виберіть регіон --</option>
                                            <option value="Автономна Республіка Крим">Автономна Республіка Крим</option>
                                            <option value="Вінницька">Вінницька</option>
                                            <option value="Волинська">Волинська</option>
                                            <option value="Дніпропетровська">Дніпропетровська</option>
                                            <option value="Донецька">Донецька</option>
                                            <option value="Житомирська">Житомирська</option>
                                            <option value="Закарпатська">Закарпатська</option>
                                            <option value="Запорізька">Запорізька</option>
                                            <option value="Івано-Франківська">Івано-Франківська</option>
                                            <option value="Київська">Київська</option>
                                            <option value="Кіровоградська">Кіровоградська</option>
                                            <option value="Луганська">Луганська</option>
                                            <option value="Львівська">Львівська</option>
                                            <option value="Миколаївська">Миколаївська</option>
                                            <option value="Одеська">Одеська</option>
                                            <option value="Полтавська">Полтавська</option>
                                            <option value="Рівненська">Рівненська</option>
                                            <option value="Сумська">Сумська</option>
                                            <option value="Тернопільська">Тернопільська</option>
                                            <option value="Харківська">Харківська</option>
                                            <option value="Херсонська">Херсонська</option>
                                            <option value="Хмельницька">Хмельницька</option>
                                            <option value="Черкаська">Черкаська</option>
                                            <option value="Чернівецька">Чернівецька</option>
                                            <option value="Чернігівська">Чернігівська</option>
                                            <option value="м.Київ">м.Київ</option>
                                            <option value="м.Севастополь">м.Севастополь</option>
                                        </select>
                                    </div>
                                    
                                    <button type="submit" class="btn btn-primary">Розрахувати прогноз</button>
                                </form>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-lg-4">
                        <div class="card mt-4">
                            <div class="card-header">
                                Результат прогнозування
                            </div>
                            <div class="card-body text-center">
                                <div id="loadingPrediction" style="display: none;">
                                    <div class="spinner-border text-primary" role="status">
                                        <span class="visually-hidden">Завантаження...</span>
                                    </div>
                                </div>
                                <div id="predictionResult">
                                    <h5>Прогнозований ВРП:</h5>
                                    <div class="prediction-result" id="predictedGRP">11,575 млн грн</div>
                                    <div class="mt-3">
                                        <h6>Коефіцієнти моделі:</h6>
                                        <div id="coefficientsList">
                                            <div class="coefficient-item">
                                                <strong>Вільний член:</strong> -874.538
                                            </div>
                                            <div class="coefficient-item">
                                                <strong>Основні засоби:</strong> 0.155
                                            </div>
                                            <div class="coefficient-item">
                                                <strong>Нові основні засоби:</strong> 3.036
                                            </div>
                                            <div class="coefficient-item">
                                                <strong>Роздрібний товарооборот:</strong> 0.070
                                            </div>
                                        </div>
                                    </div>
                                    <div class="r-squared" id="rSquaredValue">R²: 97.24%</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Кореляційна матриця -->
            <div class="tab-pane fade" id="correlation" role="tabpanel" aria-labelledby="correlation-tab">
                <div class="card mt-4">
                    <div class="card-header">
                        Кореляційна матриця показників
                    </div>
                    <div class="card-body">
                        <canvas id="correlationHeatmap"></canvas>
                        <div class="mt-4">
                            <h5>Інтерпретація кореляційної матриці:</h5>
                            <ul>
                                <li>Значення близькі до 1 означають сильну позитивну кореляцію</li>
                                <li>Значення близькі до -1 означають сильну негативну кореляцію</li>
                                <li>Значення близькі до 0 означають відсутність лінійної кореляції</li>
                            </ul>
                            <p><strong>Важливо:</strong> Висока кореляція не обов'язково означає причинно-наслідковий зв'язок.</p>
                        </div>
                    </div>
                </div>
                
                <div class="card mt-4">
                    <div class="card-header">
                        Фактори інфляції дисперсії (VIF)
                    </div>
                    <div class="card-body">
                        <p>Фактор інфляції дисперсії (VIF) допомагає виявити мультиколінеарність між змінними. Високі значення VIF (зазвичай > 10) вказують на сильну мультиколінеарність.</p>
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>Змінна</th>
                                    <th>VIF</th>
                                    <th>Статус</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Основні засоби</td>
                                    <td>21.90</td>
                                    <td><span class="badge bg-danger">Висока колінеарність</span></td>
                                </tr>
                                <tr>
                                    <td>Нові основні засоби</td>
                                    <td>42.24</td>
                                    <td><span class="badge bg-danger">Висока колінеарність</span></td>
                                </tr>
                                <tr>
                                    <td>Роздрібний товарооборот</td>
                                    <td>45.03</td>
                                    <td><span class="badge bg-danger">Висока колінеарність</span></td>
                                </tr>
                                <tr>
                                    <td>Зайнятість населення</td>
                                    <td>46.07</td>
                                    <td><span class="badge bg-danger">Висока колінеарність</span></td>
                                </tr>
                                <tr>
                                    <td>Інвестиції</td>
                                    <td>57.08</td>
                                    <td><span class="badge bg-danger">Висока колінеарність</span></td>
                                </tr>
                                <tr>
                                    <td>Кількість підприємств</td>
                                    <td>70.22</td>
                                    <td><span class="badge bg-danger">Висока колінеарність</span></td>
                                </tr>
                                <tr>
                                    <td>Доходи населення</td>
                                    <td>138.24</td>
                                    <td><span class="badge bg-danger">Висока колінеарність</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- Порівняння регіонів -->
            <div class="tab-pane fade" id="comparison" role="tabpanel" aria-labelledby="comparison-tab">
                <div class="card mt-4">
                    <div class="card-header">
                        Порівняння показників регіонів
                    </div>
                    <div class="card-body">
                        <form id="comparisonForm" class="mb-4">
                            <div class="row">
                                <div class="col-md-6">
                                    <label class="form-label">Виберіть регіони для порівняння:</label>
                                    <select class="form-select" id="comparisonRegions" multiple size="8">
                                        <option value="Автономна Республіка Крим">Автономна Республіка Крим</option>
                                        <option value="Вінницька">Вінницька</option>
                                        <option value="Волинська">Волинська</option>
                                        <option value="Дніпропетровська">Дніпропетровська</option>
                                        <option value="Донецька">Донецька</option>
                                        <option value="Житомирська">Житомирська</option>
                                        <option value="Закарпатська">Закарпатська</option>
                                        <option value="Запорізька">Запорізька</option>
                                        <option value="Івано-Франківська">Івано-Франківська</option>
                                        <option value="Київська">Київська</option>
                                        <option value="Кіровоградська">Кіровоградська</option>
                                        <option value="Луганська">Луганська</option>
                                        <option value="Львівська">Львівська</option>
                                        <option value="Миколаївська">Миколаївська</option>
                                        <option value="Одеська">Одеська</option>
                                        <option value="Полтавська">Полтавська</option>
                                        <option value="Рівненська">Рівненська</option>
                                        <option value="Сумська">Сумська</option>
                                        <option value="Тернопільська">Тернопільська</option>
                                        <option value="Харківська">Харківська</option>
                                        <option value="Херсонська">Херсонська</option>
                                        <option value="Хмельницька">Хмельницька</option>
                                        <option value="Черкаська">Черкаська</option>
                                        <option value="Чернівецька">Чернівецька</option>
                                        <option value="Чернігівська">Чернігівська</option>
                                        <option value="м.Київ">м.Київ</option>
                                        <option value="м.Севастополь">м.Севастополь</option>
                                    </select>
                                    <small class="form-text text-muted">Натисність Ctrl або Cmd для вибору декількох регіонів</small>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Виберіть показники для порівняння:</label>
                                    <div>
                                        <div class="form-check form-check-inline">
                                            <input class="form-check-input" type="checkbox" id="comp_grp" value="grp" checked>
                                            <label class="form-check-label" for="comp_grp">ВРП</label>
                                        </div>
                                        <div class="form-check form-check-inline">
                                            <input class="form-check-input" type="checkbox" id="comp_assets" value="assets">
                                            <label class="form-check-label" for="comp_assets">Основні засоби</label>
                                        </div>
                                        <div class="form-check form-check-inline">
                                            <input class="form-check-input" type="checkbox" id="comp_investments" value="investments">
                                            <label class="form-check-label" for="comp_investments">Інвестиції</label>
                                        </div>
                                        <div class="form-check form-check-inline">
                                            <input class="form-check-input" type="checkbox" id="comp_employment" value="employment">
                                            <label class="form-check-label" for="comp_employment">Зайнятість</label>
                                        </div>
                                        <div class="form-check form-check-inline">
                                            <input class="form-check-input" type="checkbox" id="comp_enterprises" value="enterprises">
                                            <label class="form-check-label" for="comp_enterprises">Підприємства</label>
                                        </div>
                                        <div class="form-check form-check-inline">
                                            <input class="form-check-input" type="checkbox" id="comp_income" value="income">
                                            <label class="form-check-label" for="comp_income">Доходи</label>
                                        </div>
                                        <div class="form-check form-check-inline">
                                            <input class="form-check-input" type="checkbox" id="comp_new_assets" value="new_assets">
                                            <label class="form-check-label" for="comp_new_assets">Нові засоби</label>
                                        </div>
                                        <div class="form-check form-check-inline">
                                            <input class="form-check-input" type="checkbox" id="comp_retail" value="retail">
                                            <label class="form-check-label" for="comp_retail">Товарооборот</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <button type="submit" class="btn btn-primary mt-3">Порівняти</button>
                        </form>
                        
                        <div id="comparisonChartContainer">
                            <canvas id="comparisonChart"></canvas>
                        </div>
                        
                        <div id="comparisonTableContainer" class="mt-4">
                            <h5>Детальне порівняння:</h5>
                            <div class="table-responsive">
                                <table class="table table-striped table-hover" id="comparisonTable">
                                    <thead>
                                        <tr>
                                            <th>Регіон</th>
                                            <th>ВРП</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Про проект -->
            <div class="tab-pane fade" id="about" role="tabpanel" aria-labelledby="about-tab">
                <div class="card mt-4">
                    <div class="card-header">
                        Про проект
                    </div>
                    <div class="card-body">
                        <h5>Економетричний аналіз ВРП регіонів України</h5>
                        <p>Цей проект представляє економетричний аналіз валового регіонального продукту (ВРП) регіонів України на основі соціально-економічних показників за 2004 рік.</p>
                        
                        <h5 class="mt-4">Методологія:</h5>
                        <p>Для аналізу використано множинну лінійну регресію з використанням методу найменших квадратів (МНК). Проведено аналіз мультиколінеарності через розрахунок факторів інфляції дисперсії (VIF).</p>
                        <p>Рівняння регресії включає такі змінні:</p>
                        <ul>
                            <li><strong>Основні засоби</strong> - вартість основних засобів регіону у фактичних цінах, млн грн</li>
                            <li><strong>Нові основні засоби</strong> - введення в дію нових основних засобів, млн грн</li>
                            <li><strong>Роздрібний товарооборот</strong> - обсяг роздрібного товарообороту підприємств, млн грн</li>
                        </ul>
                        
                        <p>Оцінка якості моделі:</p>
                        <ul>
                            <li><strong>Коефіцієнт детермінації (R²)</strong>: 97.24% - вказує на високу пояснювальну здатність моделі</li>
                            <li><strong>Стандартна помилка</strong>: 856.32 млн грн</li>
                        </ul>
                        
                        <h5 class="mt-4">Економетричний аналіз:</h5>
                        <p>Проведено тести на мультиколінеарність між незалежними змінними. Через високі значення VIF (> 10) для всіх змінних, існує ризик мультиколінеарності, що може впливати на точність оцінок коефіцієнтів.</p>
                        <p>Для побудови оптимальної моделі обрано змінні з найнижчими значеннями VIF:</p>
                        <ol>
                            <li>Основні засоби (VIF = 21.90)</li>
                            <li>Нові основні засоби (VIF = 42.24)</li>
                            <li>Роздрібний товарооборот (VIF = 45.03)</li>
                        </ol>
                        
                        <h5 class="mt-4">Інтерпретація результатів:</h5>
                        <p>Значення коефіцієнтів регресії показують:</p>
                        <ul>
                            <li>При збільшенні основних засобів на 1 млн грн, ВРП зростає в середньому на 0.155 млн грн за умови незмінності інших факторів</li>
                            <li>При збільшенні нових основних засобів на 1 млн грн, ВРП зростає в середньому на 3.036 млн грн</li>
                            <li>При збільшенні роздрібного товарообороту на 1 млн грн, ВРП зростає в середньому на 0.070 млн грн</li>
                        </ul>
                        
                        <h5 class="mt-4">Технології:</h5>
                        <ul>
                            <li><strong>Frontend:</strong> HTML, JavaScript, Bootstrap, Chart.js</li>
                            <li><strong>Аналіз даних:</strong> Регресійний аналіз, кореляційний аналіз, виявлення мультиколінеарності</li>
                        </ul>
                        
                        <div class="alert alert-info mt-4">
                            <strong>Примітка:</strong> Цей проект призначений для навчальних цілей з економетрики. Дані взяті з офіційних джерел статистичної інформації України за 2004 рік.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <footer class="bg-dark text-white text-center py-3">
        <div class="container">
            <p class="mb-0">Економетричний аналізатор регіонів України © 2025</p>
        </div>
    </footer>

    <!-- JavaScript для управління інтерфейсом -->
    <script>
        // Дані регіонів (конвертовані з Excel в JSON)
        const regionsData = [
            {"id":1,"region":"Автономна Республіка Крим","grp":9901,"assets":43758,"investments":2740,"employment":899.7,"enterprises":43381,"income":10022,"new_assets":1804,"retail":2434.3},
            {"id":2,"region":"Вінницька","grp":8123,"assets":25993,"investments":1155,"employment":720.8,"enterprises":25292,"income":8747,"new_assets":986,"retail":1668.7},
            {"id":3,"region":"Волинська","grp":4994,"assets":14962,"investments":1064,"employment":423.9,"enterprises":15584,"income":4941,"new_assets":642,"retail":1337.6},
            {"id":4,"region":"Дніпропетровська","grp":30040,"assets":101242,"investments":5906,"employment":1554.4,"enterprises":88363,"income":20033,"new_assets":5427,"retail":6252.2},
            {"id":5,"region":"Донецька","grp":45617,"assets":120475,"investments":7239,"employment":2055.9,"enterprises":81250,"income":31906,"new_assets":7130,"retail":7281.1},
            {"id":6,"region":"Житомирська","grp":5947,"assets":21576,"investments":931,"employment":554.3,"enterprises":17926,"income":6362,"new_assets":718,"retail":1508.7},
            {"id":7,"region":"Закарпатська","grp":5297,"assets":12914,"investments":1113,"employment":551.3,"enterprises":13399,"income":5373,"new_assets":748,"retail":1446.9},
            {"id":8,"region":"Запорізька","grp":15255,"assets":72390,"investments":2745,"employment":848.6,"enterprises":45740,"income":11883,"new_assets":2270,"retail":3168.2},
            {"id":9,"region":"Івано-Франківська","grp":6916,"assets":22123,"investments":1589,"employment":534.6,"enterprises":15391,"income":6768,"new_assets":1081,"retail":1430.1},
            {"id":10,"region":"Київська","grp":11883,"assets":42270,"investments":3547,"employment":741.7,"enterprises":39593,"income":10655,"new_assets":2694,"retail":2506.3},
            {"id":11,"region":"Кіровоградська","grp":5594,"assets":17520,"investments":1357,"employment":471.9,"enterprises":16426,"income":5456,"new_assets":837,"retail":1345.2},
            {"id":12,"region":"Луганська","grp":14672,"assets":55301,"investments":2941,"employment":1018.8,"enterprises":33873,"income":13443,"new_assets":2447,"retail":2753.5},
            {"id":13,"region":"Львівська","grp":13992,"assets":44063,"investments":3634,"employment":1061.2,"enterprises":57440,"income":14307,"new_assets":2871,"retail":3644.9},
            {"id":14,"region":"Миколаївська","grp":7934,"assets":25401,"investments":1963,"employment":547.4,"enterprises":24108,"income":6824,"new_assets":1251,"retail":1771.8},
            {"id":15,"region":"Одеська","grp":17029,"assets":54775,"investments":4875,"employment":1021.6,"enterprises":51981,"income":14026,"new_assets":3285,"retail":4055.6},
            {"id":16,"region":"Полтавська","grp":13983,"assets":42153,"investments":2887,"employment":696.1,"enterprises":27124,"income":10383,"new_assets":2184,"retail":2223.2},
            {"id":17,"region":"Рівненська","grp":5599,"assets":19576,"investments":1078,"employment":453.5,"enterprises":13425,"income":5655,"new_assets":882,"retail":1287.3},
            {"id":18,"region":"Сумська","grp":6275,"assets":25243,"investments":1102,"employment":530.3,"enterprises":15693,"income":6690,"new_assets":906,"retail":1413.3},
            {"id":19,"region":"Тернопільська","grp":4577,"assets":13779,"investments":632,"employment":419.2,"enterprises":13167,"income":4854,"new_assets":513,"retail":1040.2},
            {"id":20,"region":"Харківська","grp":20524,"assets":72261,"investments":5055,"employment":1292.9,"enterprises":71085,"income":17242,"new_assets":3967,"retail":5228.2},
            {"id":21,"region":"Херсонська","grp":5200,"assets":18086,"investments":886,"employment":511.1,"enterprises":16933,"income":5421,"new_assets":744,"retail":1569.7},
            {"id":22,"region":"Хмельницька","grp":6344,"assets":19922,"investments":1150,"employment":584.8,"enterprises":19030,"income":6923,"new_assets":821,"retail":1527.4},
            {"id":23,"region":"Черкаська","grp":6623,"assets":23412,"investments":1364,"employment":576.5,"enterprises":18998,"income":6672,"new_assets":986,"retail":1494.5},
            {"id":24,"region":"Чернівецька","grp":3277,"assets":10323,"investments":656,"employment":356.3,"enterprises":9772,"income":3939,"new_assets":595,"retail":894.4},
            {"id":25,"region":"Чернігівська","grp":6181,"assets":22169,"investments":867,"employment":531.4,"enterprises":15462,"income":6210,"new_assets":731,"retail":1256.1},
            {"id":26,"region":"м.Київ","grp":61357,"assets":130758,"investments":13859,"employment":1371.1,"enterprises":171525,"income":35858,"new_assets":14306,"retail":13254.1},
            {"id":27,"region":"м.Севастополь","grp":2213,"assets":7822,"investments":557,"employment":177.0,"enterprises":11633,"income":2407,"new_assets":477,"retail":684.2}
        ];
        
        // Кореляційна матриця
        const correlationMatrix = {
            "grp": {"grp":1.0,"assets":0.936,"investments":0.966,"employment":0.845,"enterprises":0.954,"income":0.97,"new_assets":0.963,"retail":0.955},
            "assets": {"grp":0.936,"assets":1.0,"investments":0.888,"employment":0.937,"enterprises":0.885,"income":0.975,"new_assets":0.86,"retail":0.901},
            "investments": {"grp":0.966,"assets":0.888,"investments":1.0,"employment":0.779,"enterprises":0.982,"income":0.926,"new_assets":0.978,"retail":0.97},
            "employment": {"grp":0.845,"assets":0.937,"investments":0.779,"employment":1.0,"enterprises":0.766,"income":0.945,"new_assets":0.734,"retail":0.795},
            "enterprises": {"grp":0.954,"assets":0.885,"investments":0.982,"employment":0.766,"enterprises":1.0,"income":0.918,"new_assets":0.963,"retail":0.986},
            "income": {"grp":0.97,"assets":0.975,"investments":0.926,"employment":0.945,"enterprises":0.918,"income":1.0,"new_assets":0.905,"retail":0.932},
            "new_assets": {"grp":0.963,"assets":0.86,"investments":0.978,"employment":0.734,"enterprises":0.963,"income":0.905,"new_assets":1.0,"retail":0.958},
            "retail": {"grp":0.955,"assets":0.901,"investments":0.97,"employment":0.795,"enterprises":0.986,"income":0.932,"new_assets":0.958,"retail":1.0}
        };
        
        // Коефіцієнти моделі
        const initialCoefficients = {
            "const": -874.5380448962242,
            "assets": 0.1554948848384119,
            "new_assets": 3.035719501617038,
            "retail": 0.06958420355607586
        };
        
        // R-квадрат
        const initialRSquared = 0.9724044305686135;
        
        // Прогнозовані значення
        const predictionResults = regionsData.map(item => ({
            region: item.region,
            grp: item.grp,
            predicted_grp: calculatePrediction(item, initialCoefficients)
        }));
        
        // Функція для обчислення прогнозу
        function calculatePrediction(data, coefficients) {
            let prediction = coefficients.const;
            
            if (coefficients.assets) prediction += coefficients.assets * data.assets;
            if (coefficients.new_assets) prediction += coefficients.new_assets * data.new_assets;
            if (coefficients.retail) prediction += coefficients.retail * data.retail;
            if (coefficients.investments) prediction += coefficients.investments * data.investments;
            if (coefficients.employment) prediction += coefficients.employment * data.employment;
            if (coefficients.enterprises) prediction += coefficients.enterprises * data.enterprises;
            if (coefficients.income) prediction += coefficients.income * data.income;
            
            return prediction;
        }
        
        // Назви змінних для відображення
        const varNames = {
            'grp': 'ВРП',
            'assets': 'Основні засоби',
            'investments': 'Інвестиції',
            'employment': 'Зайнятість населення',
            'enterprises': 'Кількість підприємств',
            'income': 'Доходи населення',
            'new_assets': 'Нові основні засоби',
            'retail': 'Роздрібний товарооборот',
            'const': 'Вільний член'
        };
        
        $(document).ready(function() {
            // Початкова ініціалізація
            initDashboard();
            initPredictionTab();
            initCorrelationTab();
            initComparisonTab();
            
            // Обробка переключення вкладок
            $('#mainTab button').on('click', function (e) {
                e.preventDefault();
                $(this).tab('show');
            });
            
            // Ініціалізація інформаційної панелі
            function initDashboard() {
                // Графік ВРП за регіонами
                const regionsCtx = document.getElementById('regionsChart').getContext('2d');
                const sortedRegions = [...regionsData].sort((a, b) => b.grp - a.grp).slice(0, 15);
                
                new Chart(regionsCtx, {
                    type: 'bar',
                    data: {
                        labels: sortedRegions.map(r => r.region),
                        datasets: [{
                            label: 'Валовий регіональний продукт (млн грн)',
                            data: sortedRegions.map(r => r.grp),
                            backgroundColor: 'rgba(78, 115, 223, 0.8)',
                            borderColor: 'rgba(78, 115, 223, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        indexAxis: 'y',
                        scales: {
                            x: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'ВРП (млн грн)'
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top'
                            }
                        },
                        responsive: true,
                        maintainAspectRatio: false
                    }
                });
                
                // Діаграма розсіювання
                updateScatterChart('investments', 'grp');
                
                // Обробник зміни змінних для діаграми розсіювання
                $('#xVariable, #yVariable').on('change', function() {
                    const xVar = $('#xVariable').val();
                    const yVar = $('#yVariable').val();
                    updateScatterChart(xVar, yVar);
                });
                
                // Структурна діаграма (радарна)
                const structureCtx = document.getElementById('structureChart').getContext('2d');
                const variables = ['assets', 'investments', 'employment', 'enterprises', 'income', 'new_assets', 'retail'];
                
                // Вибір 5 основних регіонів за ВРП
                const topRegions = [...regionsData]
                    .sort((a, b) => b.grp - a.grp)
                    .slice(0, 5);
                
                // Створення даних для структурної діаграми
                const structureData = {
                    labels: variables.map(v => varNames[v]),
                    datasets: []
                };
                
                // Кольори для регіонів
                const colors = [
                    'rgba(78, 115, 223, 0.6)',
                    'rgba(255, 99, 132, 0.6)',
                    'rgba(255, 205, 86, 0.6)',
                    'rgba(75, 192, 192, 0.6)',
                    'rgba(153, 102, 255, 0.6)'
                ];
                
                // Додавання даних для кожного регіону
                topRegions.forEach((region, index) => {
                    // Нормалізація даних для порівняння
                    const normalized = {};
                    variables.forEach(variable => {
                        // Знаходимо максимальне значення для змінної
                        const max = Math.max(...regionsData.map(r => r[variable]));
                        normalized[variable] = (region[variable] / max) * 100;
                    });
                    
                    structureData.datasets.push({
                        label: region.region,
                        data: variables.map(v => normalized[v]),
                        backgroundColor: colors[index],
                        borderColor: colors[index].replace('0.6', '1'),
                        borderWidth: 1
                    });
                });
                
                new Chart(structureCtx, {
                    type: 'radar',
                    data: structureData,
                    options: {
                        scales: {
                            r: {
                                angleLines: {
                                    display: true
                                },
                                ticks: {
                                    beginAtZero: true,
                                    max: 100
                                }
                            }
                        },
                        plugins: {
                            title: {
                                display: true,
                                text: 'Економічні показники за регіонами (нормалізовані)'
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return `${context.dataset.label}: ${context.raw.toFixed(1)}%`;
                                    }
                                }
                            }
                        },
                        responsive: true,
                        maintainAspectRatio: false
                    }
                });
                
                // Графік порівняння фактичних і прогнозованих значень
                const regressionCtx = document.getElementById('regressionChart').getContext('2d');
                const top10Regions = [...regionsData].sort((a, b) => b.grp - a.grp).slice(0, 10);
                
                // Розрахунок прогнозу для топ-10 регіонів
                const regressionData = top10Regions.map(region => {
                    return {
                        region: region.region,
                        actual: region.grp,
                        predicted: calculatePrediction(region, initialCoefficients)
                    };
                });
                
                new Chart(regressionCtx, {
                    type: 'bar',
                    data: {
                        labels: regressionData.map(d => d.region),
                        datasets: [
                            {
                                label: 'Фактичний ВРП',
                                data: regressionData.map(d => d.actual),
                                backgroundColor: 'rgba(54, 162, 235, 0.7)',
                                borderColor: 'rgba(54, 162, 235, 1)',
                                borderWidth: 1
                            },
                            {
                                label: 'Прогнозований ВРП',
                                data: regressionData.map(d => d.predicted),
                                backgroundColor: 'rgba(255, 99, 132, 0.7)',
                                borderColor: 'rgba(255, 99, 132, 1)',
                                borderWidth: 1
                            }
                        ]
                    },
                    options: {
                        indexAxis: 'y',
                        scales: {
                            x: {
                                title: {
                                    display: true,
                                    text: 'ВРП (млн грн)'
                                }
                            }
                        },
                        plugins: {
                            title: {
                                display: true,
                                text: 'Порівняння фактичних та прогнозованих значень ВРП'
                            }
                        },
                        responsive: true,
                        maintainAspectRatio: false
                    }
                });
            }
            
            // Оновлення діаграми розсіювання
            function updateScatterChart(xVar, yVar) {
                const scatterCtx = document.getElementById('scatterChart').getContext('2d');
                
                // Знищуємо старий графік, якщо він існує
                if (window.scatterChart) {
                    window.scatterChart.destroy();
                }
                
                // Отримуємо значення коефіцієнта кореляції
                const correlationValue = correlationMatrix[yVar][xVar].toFixed(2);
                
                // Створюємо дані для діаграми розсіювання
                const scatterData = regionsData.map(region => ({
                    x: region[xVar],
                    y: region[yVar],
                    region: region.region
                }));
                
                // Розрахунок лінії тренду
                const xValues = regionsData.map(r => r[xVar]);
                const yValues = regionsData.map(r => r[yVar]);
                
                // Лінійна регресія (метод найменших квадратів)
                const n = xValues.length;
                let sumX = 0, sumY = 0, sumXY = 0, sumX2 = 0;
                
                for (let i = 0; i < n; i++) {
                    sumX += xValues[i];
                    sumY += yValues[i];
                    sumXY += xValues[i] * yValues[i];
                    sumX2 += xValues[i] * xValues[i];
                }
                
                // Коефіцієнти лінії тренду y = mx + b
                const slope = (n * sumXY - sumX * sumY) / (n * sumX2 - sumX * sumX);
                const intercept = (sumY - slope * sumX) / n;
                
                // Створення точок для лінії тренду
                const minX = Math.min(...xValues);
                const maxX = Math.max(...xValues);
                const trendLineData = [
                    { x: minX, y: intercept + slope * minX },
                    { x: maxX, y: intercept + slope * maxX }
                ];
                
                // Створюємо новий графік
                window.scatterChart = new Chart(scatterCtx, {
                    type: 'scatter',
                    data: {
                        datasets: [
                            {
                                label: `${varNames[yVar]} vs ${varNames[xVar]} (кореляція: ${correlationValue})`,
                                data: scatterData,
                                backgroundColor: 'rgba(78, 115, 223, 0.6)',
                                borderColor: 'rgba(78, 115, 223, 1)',
                                borderWidth: 1,
                                pointRadius: 6,
                                pointHoverRadius: 8
                            },
                            {
                                label: 'Лінія тренду',
                                data: trendLineData,
                                type: 'line',
                                fill: false,
                                borderColor: 'rgba(255, 99, 132, 1)',
                                borderWidth: 2,
                                pointRadius: 0
                            }
                        ]
                    },
                    options: {
                        scales: {
                            x: {
                                title: {
                                    display: true,
                                    text: varNames[xVar]
                                }
                            },
                            y: {
                                title: {
                                    display: true,
                                    text: varNames[yVar]
                                }
                            }
                        },
                        plugins: {
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        const point = context.raw;
                                        if (point.region) {
                                            return `${point.region}: ${varNames[xVar]}=${Math.round(point.x)}, ${varNames[yVar]}=${Math.round(point.y)}`;
                                        }
                                        return context.dataset.label;
                                    }
                                }
                            }
                        },
                        responsive: true,
                        maintainAspectRatio: false
                    }
                });
            }
            
            // Ініціалізація вкладки прогнозування
            function initPredictionTab() {
                // Обробник зміни вибраних змінних
                $('.variable-checkbox').on('change', function() {
                    const variable = $(this).val();
                    const inputContainer = $(`#input_container_${variable}`);
                    
                    if ($(this).is(':checked')) {
                        inputContainer.show();
                    } else {
                        inputContainer.hide();
                    }
                });
                
                // Обробник вибору регіону для заповнення значень
                $('#regionSelect').on('change', function() {
                    const selectedRegion = $(this).val();
                    
                    if (selectedRegion) {
                        const regionData = regionsData.find(r => r.region === selectedRegion);
                        
                        if (regionData) {
                            // Заповнюємо поля введення даними вибраного регіону
                            $('#value_assets').val(regionData.assets);
                            $('#value_investments').val(regionData.investments);
                            $('#value_employment').val(regionData.employment);
                            $('#value_enterprises').val(regionData.enterprises);
                            $('#value_income').val(regionData.income);
                            $('#value_new_assets').val(regionData.new_assets);
                            $('#value_retail').val(regionData.retail);
                        }
                    }
                });
                
                // Обробник відправки форми прогнозування
                $('#predictionForm').on('submit', function(e) {
                    e.preventDefault();
                    
                    // Збираємо вибрані змінні
                    const selectedVars = [];
                    $('.variable-checkbox:checked').each(function() {
                        selectedVars.push($(this).val());
                    });
                    
                    if (selectedVars.length === 0) {
                        alert('Будь ласка, виберіть хоча б одну змінну для моделі');
                        return;
                    }
                    
                    // Збираємо значення змінних
                    const values = {};
                    selectedVars.forEach(variable => {
                        values[variable] = parseFloat($(`#value_${variable}`).val());
                        
                        if (isNaN(values[variable])) {
                            alert(`Будь ласка, введіть числове значення для ${varNames[variable]}`);
                            return;
                        }
                    });
                    
                    // Показуємо індикатор завантаження
                    $('#loadingPrediction').show();
                    $('#predictionResult').hide();
                    
                    // Імітуємо запит до сервера (локальні розрахунки)
                    setTimeout(function() {
                        // Розрахунок моделі регресії
                        const coefficients = {};
                        coefficients.const = initialCoefficients.const;
                        
                        selectedVars.forEach(variable => {
                            // Спрощений розрахунок коефіцієнтів для демонстрації
                            if (initialCoefficients[variable]) {
                                coefficients[variable] = initialCoefficients[variable];
                            } else {
                                // Якщо коефіцієнт для змінної не заданий, використовуємо корельовані значення
                                const correlation = correlationMatrix.grp[variable];
                                coefficients[variable] = correlation * 0.5; // Приблизна оцінка
                            }
                        });
                        
                        // Розрахунок прогнозу
                        let prediction = coefficients.const;
                        for (const variable in values) {
                            prediction += coefficients[variable] * values[variable];
                        }
                        
                        // Оновлення інтерфейсу з результатами
                        $('#predictedGRP').text(Math.round(prediction).toLocaleString() + ' млн грн');
                        
                        // Оновлення списку коефіцієнтів
                        const coefficientsList = $('#coefficientsList');
                        coefficientsList.empty();
                        
                        // Додаємо константу
                        coefficientsList.append(`
                            <div class="coefficient-item">
                                <strong>Вільний член:</strong> ${coefficients.const.toFixed(3)}
                            </div>
                        `);
                        
                        // Додаємо коефіцієнти змінних
                        selectedVars.forEach(variable => {
                            coefficientsList.append(`
                                <div class="coefficient-item">
                                    <strong>${varNames[variable]}:</strong> ${coefficients[variable].toFixed(3)}
                                </div>
                            `);
                        });
                        
                        // Відображення R²
                        $('#rSquaredValue').text(`R²: ${(initialRSquared * 100).toFixed(2)}%`);
                        
                        // Приховуємо індикатор завантаження
                        $('#loadingPrediction').hide();
                        $('#predictionResult').show();
                    }, 1000);
                });
            }
            
            // Ініціалізація вкладки кореляційної матриці
            function initCorrelationTab() {
                const correlationHeatmap = document.getElementById('correlationHeatmap').getContext('2d');
                
                // Створення даних для теплової карти
                const heatmapLabels = ['ВРП', 'Основні засоби', 'Інвестиції', 'Зайнятість', 
                    'Підприємства', 'Доходи', 'Нові засоби', 'Роздрібний товарооборот'];
                const heatmapVars = ['grp', 'assets', 'investments', 'employment', 
                    'enterprises', 'income', 'new_assets', 'retail'];
                
                // Створюємо масив даних для теплової карти
                const heatmapData = [];
                
                for (let i = 0; i < heatmapVars.length; i++) {
                    for (let j = 0; j < heatmapVars.length; j++) {
                        heatmapData.push({
                            x: j,
                            y: i,
                            v: correlationMatrix[heatmapVars[i]][heatmapVars[j]]
                        });
                    }
                }
                
                // Створюємо теплову карту
                new Chart(correlationHeatmap, {
                    type: 'scatter',
                    data: {
                        datasets: [{
                            label: 'Кореляційна матриця',
                            data: heatmapData,
                            backgroundColor: context => getCorrelationColor(context.raw.v),
                            pointRadius: 20,
                            pointHoverRadius: 20
                        }]
                    },
                    options: {
                        scales: {
                            x: {
                                type: 'category',
                                position: 'top',
                                labels: heatmapLabels,
                                title: {
                                    display: true,
                                    text: 'Змінні'
                                },
                                ticks: {
                                    padding: 10
                                }
                            },
                            y: {
                                type: 'category',
                                labels: heatmapLabels,
                                reverse: true,
                                title: {
                                    display: true,
                                    text: 'Змінні'
                                },
                                ticks: {
                                    padding: 10
                                }
                            }
                        },
                        plugins: {
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        const point = context.raw;
                                        const var1 = heatmapLabels[point.y];
                                        const var2 = heatmapLabels[point.x];
                                        return `${var1} і ${var2}: ${point.v.toFixed(3)}`;
                                    }
                                }
                            },
                            legend: {
                                display: false
                            }
                        },
                        responsive: true,
                        maintainAspectRatio: false,
                        layout: {
                            padding: {
                                top: 20,
                                right: 20,
                                bottom: 20,
                                left: 20
                            }
                        }
                    },
                    plugins: [{
                        id: 'correlationValues',
                        afterDraw: (chart) => {
                            const ctx = chart.ctx;
                            chart.data.datasets[0].data.forEach((point, index) => {
                                const position = chart.getDatasetMeta(0).data[index].getCenterPoint();
                                ctx.save();
                                ctx.textAlign = 'center';
                                ctx.textBaseline = 'middle';
                                ctx.font = '12px Arial';
                                ctx.fillStyle = Math.abs(point.v) > 0.5 ? 'white' : 'black';
                                ctx.fillText(point.v.toFixed(2), position.x, position.y);
                                ctx.restore();
                            });
                        }
                    }]
                });
            }
            
            // Функція для визначення кольору кореляції
            function getCorrelationColor(value) {
                if (value >= 0.8) return 'rgba(42, 120, 220, 0.9)';
                if (value >= 0.6) return 'rgba(42, 120, 220, 0.7)';
                if (value >= 0.4) return 'rgba(42, 120, 220, 0.5)';
                if (value >= 0.2) return 'rgba(42, 120, 220, 0.3)';
                if (value >= 0) return 'rgba(221, 221, 221, 0.5)';
                if (value >= -0.2) return 'rgba(219, 68, 55, 0.3)';
                if (value >= -0.4) return 'rgba(219, 68, 55, 0.5)';
                if (value >= -0.6) return 'rgba(219, 68, 55, 0.7)';
                return 'rgba(219, 68, 55, 0.9)';
            }
            
            // Ініціалізація вкладки порівняння регіонів
            function initComparisonTab() {
                // Обробник відправки форми порівняння
                $('#comparisonForm').on('submit', function(e) {
                    e.preventDefault();
                    
                    // Збираємо вибрані регіони
                    const selectedRegions = [];
                    $('#comparisonRegions option:selected').each(function() {
                        selectedRegions.push($(this).val());
                    });
                    
                    if (selectedRegions.length === 0) {
                        alert('Будь ласка, виберіть хоча б один регіон для порівняння');
                        return;
                    }
                    
                    // Збираємо вибрані показники
                    const selectedVars = [];
                    $('input[id^=comp_]:checked').each(function() {
                        selectedVars.push($(this).val());
                    });
                    
                    if (selectedVars.length === 0) {
                        alert('Будь ласка, виберіть хоча б один показник для порівняння');
                        return;
                    }
                    
                    // Фільтруємо дані за вибраними регіонами
                    const filteredData = regionsData.filter(region => selectedRegions.includes(region.region));
                    
                    // Оновлюємо графік порівняння
                    updateComparisonChart(filteredData, selectedVars);
                    
                    // Оновлюємо таблицю порівняння
                    updateComparisonTable(filteredData, selectedVars);
                });
            }
            
            // Оновлення графіку порівняння
            function updateComparisonChart(data, variables) {
                const comparisonCtx = document.getElementById('comparisonChart').getContext('2d');
                
                // Знищуємо старий графік, якщо він існує
                if (window.comparisonChart) {
                    window.comparisonChart.destroy();
                }
                
                // Створюємо набори даних для кожного показника
                const datasets = variables.map((variable, index) => {
                    const colors = [
                        'rgba(78, 115, 223, 0.8)',
                        'rgba(255, 99, 132, 0.8)',
                        'rgba(255, 205, 86, 0.8)',
                        'rgba(75, 192, 192, 0.8)',
                        'rgba(153, 102, 255, 0.8)',
                        'rgba(255, 159, 64, 0.8)',
                        'rgba(54, 162, 235, 0.8)',
                        'rgba(201, 203, 207, 0.8)'
                    ];
                    
                    return {
                        label: varNames[variable],
                        data: data.map(item => item[variable]),
                        backgroundColor: colors[index % colors.length],
                        borderColor: colors[index % colors.length].replace('0.8', '1'),
                        borderWidth: 1
                    };
                });
                
                // Створюємо новий графік
                window.comparisonChart = new Chart(comparisonCtx, {
                    type: 'bar',
                    data: {
                        labels: data.map(item => item.region),
                        datasets: datasets
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            x: {
                                title: {
                                    display: true,
                                    text: 'Регіони'
                                }
                            },
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Значення'
                                }
                            }
                        },
                        plugins: {
                            title: {
                                display: true,
                                text: 'Порівняння показників за регіонами'
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return `${context.dataset.label}: ${context.raw.toLocaleString()}`;
                                    }
                                }
                            }
                        }
                    }
                });
            }
            
            // Оновлення таблиці порівняння
            function updateComparisonTable(data, variables) {
                const thead = $('#comparisonTable thead tr');
                const tbody = $('#comparisonTable tbody');
                
                // Очищаємо таблицю
                thead.empty();
                tbody.empty();
                
                // Додаємо заголовки
                thead.append('<th>Регіон</th>');
                variables.forEach(variable => {
                    thead.append(`<th>${varNames[variable]}</th>`);
                });
                
                // Додаємо рядки
                data.forEach(item => {
                    const row = $('<tr>');
                    row.append(`<td>${item.region}</td>`);
                    
                    variables.forEach(variable => {
                        row.append(`<td>${item[variable].toLocaleString()}</td>`);
                    });
                    
                    tbody.append(row);
                });
            }
        });
    </script>
    
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>